<!DOCTYPE html>
<html lang="ht">
<head>
<meta charset="UTF-8">
<title>Echanj Plus</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
header { background: #1976d2; color: white; padding: 15px; text-align: center; }
.container { max-width: 400px; margin: auto; background: white; padding: 20px; margin-top: 20px; border-radius: 10px; }
input, button, select { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border: 1px solid #ccc; }
button { background: #1976d2; color: white; border: none; cursor: pointer; }
button:hover { background: #125aa0; }
.hidden { display: none; }
nav { text-align: center; margin-top: 20px; }
nav button { width: auto; margin: 5px; }
</style>
</head>
<body>

<header>
  <h1>Echanj Plus</h1>
</header>

<div id="auth-section" class="container">
  <h2>Login / Enskripsyon</h2>
  <input type="email" id="email" placeholder="Imèl">
  <input type="password" id="password" placeholder="Modpas">
  <button onclick="login()">Login</button>
  <button onclick="register()">Enskri</button>
</div>

<div id="home-section" class="container hidden">
  <h2>Byenvini</h2>
  <p>Chwazi yon opsyon:</p>
  <nav>
    <button onclick="showSection('payment-section')">Ale nan Peyman</button>
    <button onclick="logout()">Dekonekte</button>
  </nav>
</div>

<div id="payment-section" class="container hidden">
  <h2>Peyman</h2>
  <select id="payment-method" onchange="changePaymentMethod()">
    <option value="">Chwazi metòd</option>
    <option value="ussd">Voye Minit (USSD)</option>
    <option value="sms">Peman pa SMS</option>
    <option value="paryaj">Peman Paryaj Lakay</option>
  </select>

  <div id="ussd-form" class="hidden">
    <select id="operateur">
      <option value="natcom">Natcom</option>
      <option value="digicel">Digicel</option>
    </select>
    <input type="text" id="numero" placeholder="Nimewo destinatè">
    <input type="number" id="montant" placeholder="Kantite lajan (G)">
    <button onclick="sendUSSD()">Voye USSD</button>
  </div>

  <div id="sms-form" class="hidden">
    <input type="text" id="sms-number" placeholder="Nimewo">
    <input type="text" id="sms-message" placeholder="Mesaj">
    <button onclick="sendSMS()">Voye SMS</button>
  </div>

  <div id="paryaj-form" class="hidden">
    <input type="text" id="paryaj-compte" placeholder="Nimewo Kont Paryaj">
    <input type="number" id="paryaj-montant" placeholder="Kantite lajan (G)">
    <button onclick="sendParyaj()">Peye</button>
  </div>

  <button onclick="showSection('home-section')">Retounen</button>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAjK6EPlokkARHnakMaDRjqRzN-yQqlayU",
  authDomain: "echanj-plus.firebaseapp.com",
  databaseURL: "https://echanj-plus-default-rtdb.firebaseio.com",
  projectId: "echanj-plus",
  storageBucket: "echanj-plus.appspot.com",
  messagingSenderId: "117332306453",
  appId: "1:117332306453:web:xxxxxxxx"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

auth.onAuthStateChanged(user => {
  if (user) {
    showSection('home-section');
  } else {
    showSection('auth-section');
  }
});

function register(){
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  auth.createUserWithEmailAndPassword(email, password)
    .catch(err => alert(err.message));
}

function login(){
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  auth.signInWithEmailAndPassword(email, password)
    .catch(err => alert(err.message));
}

function logout(){
  auth.signOut();
}

function showSection(id){
  document.querySelectorAll('.container').forEach(div => div.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function changePaymentMethod(){
  document.getElementById('ussd-form').classList.add('hidden');
  document.getElementById('sms-form').classList.add('hidden');
  document.getElementById('paryaj-form').classList.add('hidden');
  let method = document.getElementById('payment-method').value;
  if(method === 'ussd') document.getElementById('ussd-form').classList.remove('hidden');
  if(method === 'sms') document.getElementById('sms-form').classList.remove('hidden');
  if(method === 'paryaj') document.getElementById('paryaj-form').classList.remove('hidden');
}

function sendUSSD(){
  let op = document.getElementById('operateur').value;
  let num = document.getElementById('numero').value;
  let montant = document.getElementById('montant').value;
  let code = '';
  if(op === 'natcom'){
    code = `*123*${num}*32160708*${montant}#`;
  } else {
    code = `*128*${num}*${montant}#`;
  }
  alert("USSD a: " + code);
}

function sendSMS(){
  alert("Voye SMS atravè backend (ClickSend)");
}

function sendParyaj(){
  let compte = document.getElementById('paryaj-compte').value;
  let montant = document.getElementById('paryaj-montant').value;
  alert(`Peman paryaj voye: Kont ${compte} Montant ${montant}G`);
}
</script>
</body>
    </html>
