<!DOCTYPE html>
<html lang="ht">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Echanj Plus</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f6f9;
    }

    /* Login/Signup full screen */
    #auth-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #fff;
    }
    .auth-box {
      width: 300px;
      padding: 20px;
      border-radius: 10px;
      background: #fafafa;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      text-align: center;
    }
    .auth-box input, .auth-box button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .auth-box button {
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    .auth-box button:hover {
      background: #0056b3;
    }
    .switch-link {
      margin-top: 10px;
      font-size: 14px;
      color: #007bff;
      cursor: pointer;
    }

    /* Dashboard & Sidebar */
    #dashboard {
      display: none;
      height: 100vh;
      display: flex;
    }
    .sidebar {
      width: 220px;
      background: #2c3e50;
      color: white;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
    }
    .sidebar button {
      background: none;
      border: none;
      color: white;
      padding: 15px;
      text-align: left;
      cursor: pointer;
      font-size: 16px;
    }
    .sidebar button:hover {
      background: #34495e;
    }
    .content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    .screen {
      display: none;
    }
    .active {
      display: block;
    }
  </style>
</head>
<body>

  <!-- AUTH SCREEN -->
  <div id="auth-container">
    <div class="auth-box">
      <h2 id="auth-title">Login</h2>
      <input type="email" id="email" placeholder="Email">
      <input type="password" id="password" placeholder="Password">
      <button id="loginBtn">Login</button>
      <button id="signupBtn" style="display:none;">Signup</button>
      <p class="switch-link" id="toggleAuth">Ou pa gen kont? Enskri</p>
      <p class="switch-link" id="forgotPassword">Ou bliye modpas?</p>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <div class="sidebar">
      <button onclick="showScreen('profile')">üë§ Profile</button>
      <button onclick="showScreen('send')">üì± Voye Minit</button>
      <button onclick="showScreen('payment')">üí≥ Peman</button>
      <button onclick="showScreen('feedback')">‚≠ê Feedback</button>
      <button onclick="logout()">üö™ Logout</button>
    </div>
    <div class="content">
      <div id="profile" class="screen active">
        <h2>Profile</h2>
        <p id="userEmail"></p>
        <input type="text" id="fullName" placeholder="Non konpl√®">
        <input type="text" id="phone" placeholder="Nimewo telef√≤n">
        <button onclick="saveProfile()">Sove</button>
      </div>

      <div id="send" class="screen">
        <h2>Voye Minit</h2>
        <input type="number" id="minutes" placeholder="Antre kantite minit">
        <select id="operator">
          <option value="Digicel">Digicel</option>
          <option value="Natcom">Natcom</option>
        </select>
        <button onclick="calculateFee()">Kalkile Fr√®</button>
        <p id="feeResult"></p>
      </div>

      <div id="payment" class="screen">
        <h2>Peman</h2>
        <select id="payMethod">
          <option value="MonCash">MonCash</option>
          <option value="NatCash">NatCash</option>
          <option value="ParyajLakay">Paryaj Lakay</option>
          <option value="ParyajPam">Paryaj Pam</option>
        </select>
        <input type="text" id="accountName" placeholder="Non kont lan">
        <input type="text" id="accountNumber" placeholder="Nimewo kont lan">
        <input type="number" id="amount" placeholder="Montan">
        <button onclick="submitPayment()">Soum√®t</button>
      </div>

      <div id="feedback" class="screen">
        <h2>Feedback</h2>
        <p>Bay konfyans ou sou sist√®m lan:</p>
        <div>
          <span onclick="setRating(1)">‚≠ê</span>
          <span onclick="setRating(2)">‚≠ê‚≠ê</span>
          <span onclick="setRating(3)">‚≠ê‚≠ê‚≠ê</span>
          <span onclick="setRating(4)">‚≠ê‚≠ê‚≠ê‚≠ê</span>
          <span onclick="setRating(5)">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
        </div>
        <input type="text" id="comment" placeholder="K√≤mant√® ou">
        <button onclick="submitFeedback()">Voye</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyB1VTPakleoggsbLdpm_HS7nSb3A7A99Qw",
      authDomain: "echanj-plus-778cd.firebaseapp.com",
      databaseURL: "https://echanj-plus-778cd-default-rtdb.firebaseio.com",
      projectId: "echanj-plus-778cd",
      storageBucket: "echanj-plus-778cd.firebasestorage.app",
      messagingSenderId: "111144762929",
      appId: "1:111144762929:web:e64ce9a6da65781c289f10",
      measurementId: "G-J1BQRF32ZW"
    };

    // Init Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    // Auth Elements
    const authContainer = document.getElementById("auth-container");
    const dashboard = document.getElementById("dashboard");
    const loginBtn = document.getElementById("loginBtn");
    const signupBtn = document.getElementById("signupBtn");
    const toggleAuth = document.getElementById("toggleAuth");

    let isLogin = true;

    toggleAuth.addEventListener("click", () => {
      isLogin = !isLogin;
      document.getElementById("auth-title").innerText = isLogin ? "Login" : "Signup";
      loginBtn.style.display = isLogin ? "block" : "none";
      signupBtn.style.display = isLogin ? "none" : "block";
      toggleAuth.innerText = isLogin ? "Ou pa gen kont? Enskri" : "Ou gen kont? Login";
    });

    // Login
    loginBtn.addEventListener("click", () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      auth.signInWithEmailAndPassword(email, password)
        .then(() => showDashboard())
        .catch(err => alert(err.message));
    });

    // Signup
    signupBtn.addEventListener("click", () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      auth.createUserWithEmailAndPassword(email, password)
        .then(() => showDashboard())
        .catch(err => alert(err.message));
    });

    // Show dashboard if logged in
    auth.onAuthStateChanged(user => {
      if (user) {
        showDashboard();
        document.getElementById("userEmail").innerText = "Konekte k√≤m: " + user.email;
      } else {
        authContainer.style.display = "flex";
        dashboard.style.display = "none";
      }
    });

    function showDashboard() {
      authContainer.style.display = "none";
      dashboard.style.display = "flex";
    }

    function logout() {
      auth.signOut();
    }

    // Switch Screens
    function showScreen(id) {
      document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // Save Profile
    function saveProfile() {
      const user = auth.currentUser;
      if (!user) return;
      db.ref("users/" + user.uid).set({
        name: document.getElementById("fullName").value,
        phone: document.getElementById("phone").value,
        email: user.email
      });
      alert("Profile sove!");
    }

    // Send Minutes
    function calculateFee() {
      let minit = parseInt(document.getElementById("minutes").value);
      if (!minit) return alert("Antre kantite minit!");
      let fee = Math.round(minit * 0.175);
      let receive = minit - fee;
      document.getElementById("feeResult").innerText =
        `Pou ${minit} minit ‚Üí Fr√®: ${fee} gdes, Ou resevwa: ${receive} gdes`;
    }

    // Payment
    function submitPayment() {
      alert("Peman soum√®t av√®k siks√®!");
    }

    // Feedback
    let rating = 0;
    function setRating(star) {
      rating = star;
      alert("Ou bay " + star + " ‚≠ê");
    }
    function submitFeedback() {
      const comment = document.getElementById("comment").value;
      db.ref("feedback").push({
        user: auth.currentUser.email,
        rating,
        comment
      });
      alert("Feedback voye!");
    }
  </script>
</body>
            </html>
