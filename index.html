<!DOCTYPE html>
<html lang="ht">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Echanj Plus</title>
<style>
  /* ===== Full screen + font ===== */
  * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
  html, body { width:100%; height:100%; background:#0b1e4b; color:#fff; overflow-x:hidden; }

  /* ===== Logo + Kare animasyon ===== */
  #logoContainer {
    width:100%; height:200px; display:flex; justify-content:center; align-items:center; position:relative; margin-top:50px;
  }
  #logoSquare {
    width:150px; height:150px; background: rgba(255,255,255,0.1); backdrop-filter: blur(5px);
    display:flex; justify-content:center; align-items:center; border-radius:20px;
    animation: rotateSquare 4s linear infinite;
  }
  #logoText {
    font-size:36px; font-weight:bold; color:#ffd700; text-shadow:2px 2px 5px #000;
  }
  @keyframes rotateSquare {
    0%{transform:rotate(0deg);}
    50%{transform:rotate(180deg);}
    100%{transform:rotate(360deg);}
  }

  /* ===== Forms ===== */
  .authContainer { width:100%; display:flex; justify-content:center; margin-top:30px; }
  .formBox { background: rgba(255,255,255,0.05); padding:30px; border-radius:18px; width:90%; max-width:400px; backdrop-filter: blur(5px); }
  input { width:100%; padding:10px; margin:10px 0; border-radius:8px; border:none; }
  button { width:100%; padding:10px; margin:10px 0; border:none; border-radius:8px; background:#ffd700; color:#000; font-weight:bold; cursor:pointer; }
  .switchLink { text-align:center; margin-top:10px; cursor:pointer; color:#00ffff; }

  /* ===== Dashboard ===== */
  #dashboard { display:none; padding:20px; }
  #dashboard h2 { text-align:center; margin-bottom:20px; }
  .optionsBar { display:flex; justify-content:center; gap:20px; margin-bottom:20px; }
  .optionBtn { padding:10px 15px; background:#ffd700; color:#000; border:none; border-radius:10px; cursor:pointer; font-weight:bold; }

  /* ===== Wallet Balances ===== */
  #wallet { display:flex; justify-content:center; gap:20px; margin-bottom:20px; }
  .balanceCard { background: rgba(255,255,255,0.1); padding:15px 25px; border-radius:15px; text-align:center; }

  /* ===== Modal Kondisyon ===== */
  #termsModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); justify-content:center; align-items:center; }
  #termsContent { background:#fff; color:#000; padding:20px; border-radius:15px; width:90%; max-width:500px; max-height:80%; overflow-y:auto; }
  #closeModal { margin-top:20px; padding:10px; cursor:pointer; background:#0b1e4b; color:#fff; border:none; border-radius:10px; }
</style>
</head>
<body>

<!-- Logo + Kare animasyon -->
<div id="logoContainer">
  <div id="logoSquare">
    <div id="logoText">ECHANJ PLUS</div>
  </div>
</div>

<!-- Authentication Forms -->
<div class="authContainer" id="authSection">
  <!-- Signup Form -->
  <div class="formBox" id="signupFormBox">
    <h3>Enskri</h3>
    <input type="text" id="signupName" placeholder="Non ou" required>
    <input type="email" id="signupEmail" placeholder="Imèl" required>
    <input type="text" id="signupPhone" placeholder="Nimero Telefòn (+509...)" required>
    <input type="date" id="signupDOB" placeholder="Dat nesans" required>
    <input type="password" id="signupPassword" placeholder="Modpas" required>
    <label>
      <input type="checkbox" id="acceptTerms" required> Mwen li <a href="#" id="openTerms">Kondisyon yo</a> e mwen dakò
    </label>
    <button id="signupBtn">Kreye kont</button>
    <div class="switchLink" id="toLogin">Ou deja gen kont? Konekte</div>
  </div>

  <!-- Login Form -->
  <div class="formBox" id="loginFormBox" style="display:none;">
    <h3>Konekte</h3>
    <input type="email" id="loginEmail" placeholder="Imèl" required>
    <input type="password" id="loginPassword" placeholder="Modpas" required>
    <button id="loginBtn">Konekte</button>
    <div class="switchLink" id="toSignup">Pa gen kont? Enskri</div>
  </div>
</div>

<!-- Dashboard -->
<div id="dashboard">
  <h2>Byenveni, <span id="userName"></span></h2>
  <div class="optionsBar">
    <button class="optionBtn" id="optionHome">Akèy</button>
    <button class="optionBtn" id="optionPayment">Peman</button>
    <button class="optionBtn" id="optionProfile">Profil</button>
  </div>

  <!-- Wallet Balances -->
  <div id="wallet">
    <div class="balanceCard">Sale Balance: <span id="saleBalance">0</span> minit</div>
    <div class="balanceCard">Withdraw Balance: <span id="withdrawBalance">0</span> Gdes</div>
  </div>

  <!-- Kontni opsyon -->
  <div id="optionContent"></div>
</div>

<!-- Modal Kondisyon -->
<div id="termsModal">
  <div id="termsContent">
    <h3>Kondisyon Sistem Echanj Plus</h3>
    <p>Tout itilizatè dwe gen 18 ane oswa plis. Sèvis la disponib sèlman pou moun ki nan Ayiti. Tout tranzaksyon final, pa gen ranvèsman...</p>
    <button id="closeModal">Fèmen</button>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";
import { getDatabase, ref, set, update, push, get } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js";

// ===== Firebase Config =====
const firebaseConfig = {
  apiKey: "AIzaSyB1VTPakleoggsbLdpm_HS7nSb3A7A99Qw",
  authDomain: "echanj-plus-778cd.firebaseapp.com",
  databaseURL: "https://echanj-plus-778cd-default-rtdb.firebaseio.com",
  projectId: "echanj-plus-778cd",
  storageBucket: "echanj-plus-778cd.appspot.com",
  messagingSenderId: "111144762929",
  appId: "1:111144762929:web:e64ce9a6da65781c289f10"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// ===== Switch Forms =====
const signupFormBox = document.getElementById('signupFormBox');
const loginFormBox = document.getElementById('loginFormBox');
document.getElementById('toLogin').addEventListener('click',()=>{ signupFormBox.style.display='none'; loginFormBox.style.display='block'; });
document.getElementById('toSignup').addEventListener('click',()=>{ loginFormBox.style.display='none'; signupFormBox.style.display='block'; });

// ===== Modal =====
const termsModal = document.getElementById('termsModal');
document.getElementById('openTerms').addEventListener('click',()=>{ termsModal.style.display='flex'; });
document.getElementById('closeModal').addEventListener('click',()=>{ termsModal.style.display='none'; });

// ===== Signup =====
document.getElementById('signupBtn').addEventListener('click',()=>{
  const name = document.getElementById('signupName').value;
  const email = document.getElementById('signupEmail').value;
  const phone = document.getElementById('signupPhone').value;
  const dob = document.getElementById('signupDOB').value;
  const password = document.getElementById('signupPassword').value;
  const accept = document.getElementById('acceptTerms').checked;

  if(!accept){ alert("Ou dwe aksepte kondisyon yo!"); return; }

  // Verify age >=18
  const birthDate = new Date(dob);
  const ageDifMs = Date.now() - birthDate.getTime();
  const ageDate = new Date(ageDifMs);
  const age = Math.abs(ageDate.getUTCFullYear() - 1970);
  if(age < 18){ alert("Ou dwe gen 18 ane oswa plis!"); return; }

  createUserWithEmailAndPassword(auth,email,password)
    .then(userCredential=>{
      const user = userCredential.user;
      const userRef = ref(db,'users/'+user.uid);
      set(userRef,{
        name, email, phone, dob, saleBalance:0, withdrawBalance:0, createdAt:new Date().toISOString()
      }).then(()=>{
        alert("Kreye kont avèk siksè!");
        signupFormBox.style.display='none';
        loginFormBox.style.display='block';
      });
    })
    .catch(error=>alert(error.message));
});

// ===== Login =====
document.getElementById('loginBtn').addEventListener('click',()=>{
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  signInWithEmailAndPassword(auth,email,password)
    .then(userCredential=>{
      const user = userCredential.user;
      document.getElementById('authSection').style.display='none';
      document.getElementById('dashboard').style.display='block';
      // Load user info
      get(ref(db,'users/'+user.uid)).then(snapshot=>{
        if(snapshot.exists()){
          const data = snapshot.val();
          document.getElementById('userName').innerText = data.name;
          document.getElementById('saleBalance').innerText = data.saleBalance;
          document.getElementById('withdrawBalance').innerText = data.withdrawBalance.toFixed(2);
        }
      });
    })
    .catch(error=>alert(error.message));
});
</script>

</body>
                                   </html>
