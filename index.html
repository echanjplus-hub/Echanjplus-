<!DOCTYPE html>
<html lang="ht">
<head>
<meta charset="UTF-8">
<title>Echanj Plus</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; margin: 0; padding: 0; }
    .container { max-width: 400px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1);}
    h2 { text-align: center; color: #333; }
    input { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ccc; border-radius: 5px; }
    button { width: 100%; padding: 10px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #218838; }
    .link { text-align: center; margin-top: 10px; color: #007bff; cursor: pointer; }
    .link:hover { text-decoration: underline; }
    .hidden { display: none; }
    .ussd-btn { display: block; width: 100%; background: #007bff; color: white; padding: 10px; border: none; margin: 5px 0; border-radius: 5px; text-align: center; text-decoration: none; }
    .ussd-btn:hover { background: #0056b3; }
</style>
</head>
<body>

<div class="container" id="registerPage">
    <h2>Enskripsyon</h2>
    <input type="text" id="firstName" placeholder="Non" required>
    <input type="text" id="lastName" placeholder="Prenon" required>
    <input type="tel" id="phoneNumber" placeholder="Nimewo telefòn (+509...)" required>
    <div id="recaptcha-container"></div>
    <button onclick="sendVerificationCode()">Voye Kòd SMS</button>
    <input type="text" id="verificationCode" placeholder="Antre kòd SMS la">
    <input type="email" id="email" placeholder="Imèl" required>
    <input type="password" id="password" placeholder="Modpas" required>
    <button onclick="register()">Enskri</button>
    <div class="link" onclick="showLogin()">Si w gen yon kont deja, konekte</div>
</div>

<div class="container hidden" id="loginPage">
    <h2>Konekte</h2>
    <input type="email" id="loginEmail" placeholder="Imèl">
    <input type="password" id="loginPassword" placeholder="Modpas">
    <button onclick="login()">Konekte</button>
    <div class="link" onclick="showRegister()">Pa gen kont? Enskri</div>
</div>

<div class="container hidden" id="ussdPage">
    <h2>Voye Minit</h2>
    <p>Chwazi metòd ou vle itilize pou voye minit:</p>
    <a class="ussd-btn" href="tel:*128*50947111123*100%23">Digicel 100 G</a>
    <a class="ussd-btn" href="tel:*128*1%23">Konfime Digicel</a>
    <a class="ussd-btn" href="tel:*123*88888888*32160708*100%23">Natcom 100 G</a>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAjK6EPlokkARHnakMaDRjqRzN-yQqlayU",
    authDomain: "echanj-plus.firebaseapp.com",
    projectId: "echanj-plus",
    storageBucket: "echanj-plus.firebasestorage.app",
    messagingSenderId: "117332306453",
    appId: "1:117332306453:web:41d04226aa15ca5c3fbc1c",
    measurementId: "G-LPGLMCR7HP"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  function showLogin() {
    document.getElementById("registerPage").classList.add("hidden");
    document.getElementById("loginPage").classList.remove("hidden");
  }

  function showRegister() {
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("registerPage").classList.remove("hidden");
  }

  function sendVerificationCode() {
    const phoneNumber = document.getElementById("phoneNumber").value;
    const appVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container');
    auth.signInWithPhoneNumber(phoneNumber, appVerifier)
      .then(confirmationResult => {
        window.confirmationResult = confirmationResult;
        alert("Kòd la voye sou SMS ou!");
      })
      .catch(error => {
        console.error(error);
        alert("Erè: " + error.message);
      });
  }

  function register() {
    const code = document.getElementById("verificationCode").value;
    window.confirmationResult.confirm(code)
      .then(result => {
        alert("Enskripsyon reyalize!");
        document.getElementById("registerPage").classList.add("hidden");
        document.getElementById("ussdPage").classList.remove("hidden");
      })
      .catch(error => {
        alert("Kòd pa kòrèk: " + error.message);
      });
  }

  function login() {
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;
    auth.signInWithEmailAndPassword(email, password)
      .then(userCredential => {
        alert("Koneksyon reyalize!");
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("ussdPage").classList.remove("hidden");
      })
      .catch(error => {
        alert("Erè: " + error.message);
      });
  }
</script>
</body>
</html>
